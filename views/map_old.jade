extends layout

block content
    .container
        #cabecera.col-md-12
            div.col-md-12(style="padding:0px;") Geolocalización de objetos móviles
        #map.map

            div#flotante
                .input-group.flex-nowrap.col-12
                    .input-group-prepend
                        span.input-group-text Id
                    input(type="text" id='id1' class="form-control" placeholder="Id" aria-label="Id" aria-describedby="addon-wrapping")
                .input-group.flex-nowrap.col-12
                    .input-group-prepend
                        span.input-group-text Coord X
                    input(type="text" id='coord_x' class="form-control" placeholder="Coord X" aria-label="Coord X" aria-describedby="addon-wrapping")
                .input-group.flex-nowrap.col-12
                    .input-group-prepend
                        span.input-group-text Coord Y
                    input(type="text" id='coord_y' class="form-control" placeholder="Coord Y" aria-label="Coord Y" aria-describedby="addon-wrapping")
                .input-group.flex-nowrap.col-12
                    .input-group-prepend
                        span.input-group-text fecha
                    input(type="text/javascript" id='fecha' class="form-control" placeholder="Fecha" aria-label="Fecha" aria-describedby="addon-wrapping")

    script(type='text/javascript').
        var projection = ol.proj.get('EPSG:3857');
        var projectionExtent = projection.getExtent();
        var size = ol.extent.getWidth(projectionExtent) / 256;
        var resolutions = new Array(14);
        var matrixIds = new Array(14);
        var numResultados = 0;
        for (var z = 0; z < 22; ++z) {
            // generate resolutions and matrixIds arrays for this WMTS
            resolutions[z] = size / Math.pow(2, z);
            matrixIds[z] = z;
        };


        var tileGrid = new ol.tilegrid.WMTS({
            origin: ol.extent.getTopLeft(projectionExtent),
            resolutions: resolutions,
            matrixIds: matrixIds
        });

        var pnoaWmts = new ol.layer.Tile({
            opacity: 0.7,
            source: new ol.source.WMTS({
                url: 'http://www.ign.es/wmts/pnoa-ma',
                layer: 'OI.OrthoimageCoverage',
                matrixSet: 'EPSG:3857',
                format: 'image/jpeg',
                projection: projection,
                tileGrid: tileGrid,
                style: 'default',
                wrapX: true
            })
        });

        var map = new ol.Map({
            layers: [pnoaWmts],
            target: 'map',
            controls: ol.control.defaults().extend([
                new ol.control.ScaleLine({className: 'ol-scale-line', target: document.getElementById('scale-line')})
            ]),
            view: new ol.View({
                center: ol.proj.transform([#{lng}, #{lat}], 'EPSG:4326', 'EPSG:3857'), zoom: 6
            })
        });

